<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>MSF documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	      <link rel="stylesheet" href="../styles/style.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">MSF documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content interface">
                   <div class="content-data">












<ol class="breadcrumb">
  <li>Interfaces</li>
  <li>DayMain</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/app/maintenances/formulaire/formulaire.component.ts</code>
        </p>



        <section>
            <h3 id="index">Index</h3>
            <table class="table table-sm table-bordered index-table">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <h6><b>Properties</b></h6>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <ul class="index-list">
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#EndTime">EndTime</a>
                                </li>
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#idMaintenance">idMaintenance</a>
                                </li>
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#StartTime">StartTime</a>
                                </li>
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#Subject">Subject</a>
                                </li>
                            </ul>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>



            <section>
                <h3 id="inputs">Properties</h3>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="EndTime"></a>
                                        <span class="name"><b>EndTime</b><a href="#EndTime"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>EndTime:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="idMaintenance"></a>
                                        <span class="name"><b>idMaintenance</b><a href="#idMaintenance"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>idMaintenance:         <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="StartTime"></a>
                                        <span class="name"><b>StartTime</b><a href="#StartTime"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>StartTime:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="Subject"></a>
                                        <span class="name"><b>Subject</b><a href="#Subject"><span class="icon ion-ios-link"></span></a></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>Subject:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                        </tbody>
                    </table>
            </section>
    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Component, EventEmitter, Input, Output, ViewChild } from &#x27;@angular/core&#x27;;
import { FormBuilder, FormControl, FormGroup, Validators } from &#x27;@angular/forms&#x27;;
import { CheckBoxComponent } from &#x27;@syncfusion/ej2-angular-buttons&#x27;;
import { MultiSelectComponent } from &#x27;@syncfusion/ej2-angular-dropdowns&#x27;;
import { RecurrenceEditor } from &#x27;@syncfusion/ej2-angular-schedule&#x27;;
import * as moment from &#x27;moment&#x27;;
import { Maintenance } from &#x27;src/app/Class/Maintenance&#x27;;
import { MaintenanceService } from &#x27;src/app/Service/maintenance.service&#x27;;
import { MatNativeDateModule } from &#x27;@angular/material&#x27;;



// var momentDay &#x3D; require(&#x27;moment-weekdaysin&#x27;);

@Component({
  selector: &#x27;app-formulaire&#x27;,
  templateUrl: &#x27;./formulaire.component.html&#x27;,
  styleUrls: [&#x27;./formulaire.component.css&#x27;]
})
export class FormulaireComponent {


  constructor(private fb: FormBuilder, private ms: MaintenanceService) {
    this.createForm();
  }
  //#region Declaration Variable
  maintenances: Maintenance[];

  // date &#x3D; new Date();

  periode: any;

  @Input() lrepeat: any;
  @Input() lEnd: any;
  @Output() messageEvent &#x3D; new EventEmitter&lt;any&gt;();

  maintenanceForm: FormGroup;


  // hasUnitNumber &#x3D; false;


  @ViewChild(&#x27;checkbox&#x27;)
  public mulObj: MultiSelectComponent;
  @ViewChild(&#x27;selectall&#x27;)
  public checkboxObj: CheckBoxComponent;
  @ViewChild(&#x27;dropdown&#x27;)
  public dropdownObj: CheckBoxComponent;
  @ViewChild(&#x27;select&#x27;)
  public reorderObj: CheckBoxComponent;
  public mode: string;
  public filterPlaceholder: string;
  // define the data with category
  public days: { [key: string]: Object }[] &#x3D; [
    { Name: &#x27;Monday&#x27;, Code: &#x27;1&#x27; },
    { Name: &#x27;Tuesday&#x27;, Code: &#x27;2&#x27; },
    { Name: &#x27;Wednesday&#x27;, Code: &#x27;3&#x27; },
    { Name: &#x27;Thursday&#x27;, Code: &#x27;4&#x27; },
    { Name: &#x27;Friday&#x27;, Code: &#x27;5&#x27; },
    { Name: &#x27;Saturday&#x27;, Code: &#x27;6&#x27; },
    { Name: &#x27;Sunday&#x27;, Code: &#x27;0&#x27; }
  ];
  public currents: { [key: string]: Object }[] &#x3D; [
    { Name: &#x27;First&#x27;, Code: &#x27;1&#x27; },
    { Name: &#x27;Second&#x27;, Code: &#x27;2&#x27; },
    { Name: &#x27;Third&#x27;, Code: &#x27;3&#x27; },
    { Name: &#x27;Last&#x27;, Code: &#x27;4&#x27; },
  ];
  public lMonth: { [key: string]: Object }[] &#x3D; [
    { Name: &#x27;January&#x27;, Code: 0 },
    { Name: &#x27;February&#x27;, Code: 1 },
    { Name: &#x27;March&#x27;, Code: 2 },
    { Name: &#x27;April&#x27;, Code: 3 },
    { Name: &#x27;May&#x27;, Code: 4 },
    { Name: &#x27;June&#x27;, Code: 5 },
    { Name: &#x27;July&#x27;, Code: 6 },
    { Name: &#x27;August&#x27;, Code: 7 },
    { Name: &#x27;September&#x27;, Code: 8 },
    { Name: &#x27;October&#x27;, Code: 9 },
    { Name: &#x27;November&#x27;, Code: 10 },
    { Name: &#x27;December&#x27;, Code: 11 },
  ];
  // map the groupBy field with category column
  public checkFields: Object &#x3D; { text: &#x27;Name&#x27;, value: &#x27;Code&#x27; };
  // set the placeholder to the MultiSelect input
  public checkWaterMark &#x3D; &#x27;Select Day(s)&#x27;;
  // set the MultiSelect popup height
  public popHeight &#x3D; &#x27;350px&#x27;;
  //#endregion

  createForm() {
    this.maintenanceForm &#x3D; this.fb.group({
      maintenance: new FormControl(&#x27;&#x27;, [Validators.required]),
      executor: new FormControl(&#x27;&#x27;, [Validators.required]),
      periodicity: new FormControl(&#x27;&#x27;, [Validators.required]),
      duration: new FormControl(&#x27;&#x27;, [Validators.required]),
      recurrence: new FormControl(&#x27;&#x27;, [Validators.required]),
      description: new FormControl(&#x27;&#x27;, [Validators.required]),
      date: new FormControl(&#x27;&#x27;, [Validators.required]),
      StartTime: new FormControl(&#x27;&#x27;, [Validators.required]),
      count: new FormControl(&#x27;&#x27;),
      until: new FormControl(&#x27;&#x27;),
    });
  }

  public onChange(args: any): void {
    // TODO Hicham trouver une solution
    if (args.itemData.task !&#x3D; undefined) {
      this.onSelection(args.itemData);
    }
    console.log(args.itemData.StartTime);
    this.mulObj.showSelectAll &#x3D; this.checkboxObj.checked;

  }

  ngOnInit() {

    this.ms.getMaintenance().subscribe((data: Maintenance[]) &#x3D;&gt; {
      this.maintenances &#x3D; data;
    });


    const recurrObject: RecurrenceEditor &#x3D; new RecurrenceEditor({
    });



    this.mode &#x3D; &#x27;CheckBox&#x27;;
    this.filterPlaceholder &#x3D; &#x27;Select Day(s)&#x27;;

  }
  onSelection(value) {

    this.periode &#x3D; value.periodicity;

    this.maintenanceForm &#x3D; this.fb.group({
      idMaintnance: new FormControl(value._id, [Validators.required]),
      maintenance: new FormControl(value.task, [Validators.required]),
      executor: new FormControl(value.executor, [Validators.required]),
      periodicity: new FormControl(value.periodicity, [Validators.required]),
      duration: new FormControl(value.duration, [Validators.required]),
      recurrence: new FormControl(value.recurrence, [Validators.required]),
      description: new FormControl(value.description, [Validators.required]),
      StartTime: new FormControl(&#x27;&#x27;, [Validators.required]),
      // TODO Hicham  count ou until a false
      count: new FormControl(&#x27;&#x27;),
      until: new FormControl(&#x27;&#x27;),
      listDay: new FormControl([]),
      end: new FormControl(&#x27;&#x27;),
      interval: new FormControl(&#x27;&#x27;),
      dayOcc: new FormControl(&#x27;&#x27;),
      day: new FormControl(&#x27;&#x27;),
      choix: new FormControl(&#x27;&#x27;),
      current: new FormControl(&#x27;&#x27;),
    });

  }

  saveDate(maintenance) {

    switch (maintenance.value.periodicity) {
      case &#x27;Daily&#x27;: {
        this.saveDaily(maintenance.value);
        break;
      }
      case &#x27;Weekly&#x27;: {
        this.saveWeekly(maintenance.value);
        break;
      }
      case &#x27;Monthly&#x27;: {
        this.saveMonthly(maintenance.value);
        break;
      }
      case &#x27;Yearly&#x27;: {
        this.saveYearly(maintenance.value);
        break;
      }

      default:
        break;
    }



    // this.messageEvent.emit(date);
  }

  //#region save by Year
  saveYearly(maintenance) {

    console.log(&#x27;traitement Yearly&#x27;);
    console.log(maintenance.end);
  }
  //#endregion

  //#region save by Month
  saveMonthly(maintenance) {
    if (maintenance.end &#x3D;&#x3D;&#x3D; &#x27;Until&#x27;) { this.planMonthlyUntil(maintenance); } else { this.planMonthlyCount(maintenance); }
  }
  /**
   *
   * @param maintenance
   * premet la plannification d&#x27;un nombre de fois definit
   *
   * soit selon un le neme jours du mois
   * ou selon une date definit
   */
  planMonthlyCount(maintenance: any) {

    // splite date month year
    const month &#x3D; moment(maintenance.StartTime).format(&#x27;MM&#x27;);
    const year &#x3D; parseInt(moment(maintenance.StartTime).format(&#x27;YYYY&#x27;));
    const time &#x3D; moment(maintenance.StartTime).format(&#x27;LT&#x27;);
    // create date with month and year
    const date &#x3D; moment(month + &#x27;&#x27; + year, &#x27;M/YYYY&#x27;);

    // array for stock new Maintenance
    const newMaintenances: any &#x3D; [];

    // loop for nomber occurence ask
    for (let index &#x3D; 0; index &lt; maintenance.count; index++) {
      //this.traitementCurrentByMonth(maintenance.current, date, maintenance);
      //maintenance.StartTime &#x3D; (moment(maintenance.StartTime.format(&#x27;ll&#x27;) + &#x27; &#x27; + time).format(&#x27;llll&#x27;));
      //this.traitementPlanByDay(maintenance, newMaintenances);
      //date.add(maintenance.interval, &#x27;M&#x27;);
      this.traitementByMonth(maintenance,newMaintenances,date,time)
    }

    this.messageEvent.emit(newMaintenances);
    this.createForm();


  }
  /**
   *
   * @param maintenance
   *
   * premet la plannification jusqu&#x27;une date limite
   *
   * soit selon un le neme jours du mois
   * ou selon une date definit
   */
  planMonthlyUntil(maintenance: any) {
    const newMaintenances: any &#x3D; [];
    const time &#x3D; moment(maintenance.StartTime).format(&#x27;LT&#x27;);
    const month &#x3D; moment(maintenance.StartTime).format(&#x27;M&#x27;);
    const year &#x3D; moment(maintenance.StartTime).format(&#x27;YYYY&#x27;);
    const date &#x3D; moment(month + &#x27; &#x27; + year, &#x27;M YYYY&#x27;).day(maintenance.day);



    while (moment(maintenance.StartTime).isBefore(moment(maintenance.until))) {
     this.traitementByMonth(maintenance,newMaintenances,date,time);
    }
    this.messageEvent.emit(newMaintenances);
    this.createForm();


  }
  //#endregion

  //#region save by Week
  /**
   *
   * @param maintenance
   * determine si la fin de la plannification
   * se fait selon une date limite ou un nombre de repetition
   *  pour une plannification par semaine
   */
  saveWeekly(maintenance) {
    if (maintenance.end &#x3D;&#x3D;&#x3D; &#x27;Until&#x27;) { this.planWeekUntil(maintenance); } else { this.planWeekCount(maintenance); }
  }

  /**
   *
   * @param maintenance
   *
   * traitement du planning par semaine avec nombre de repétition determiner
   */
  planWeekCount(maintenance: any) {

    const nbWeek &#x3D; moment(moment(maintenance.StartTime)).week();;
    const newMaintenances: any &#x3D; [];
    const time &#x3D; moment(maintenance.StartTime).format(&#x27;LT&#x27;);
    for (let index &#x3D; 0; index &lt; maintenance.count; index++) {
      console.log(index);
      maintenance.listDay.forEach(element &#x3D;&gt; {
        const date &#x3D; (moment().day(element).week(nbWeek + index).format(&#x27;LL&#x27;));
        maintenance.StartTime &#x3D; (moment(date + &#x27; &#x27; + time).format(&#x27;llll&#x27;));
        this.traitementPlanByDay(maintenance, newMaintenances);
        maintenance.StartTime &#x3D; moment(maintenance.StartTime).add(maintenance.interval, &#x27;weeks&#x27;);
      });

    }

    // console.log(newMaintenances)

    this.messageEvent.emit(newMaintenances);
    this.createForm();

  }
  /**
   *
   * @param maintenance
   * traitement du planning par semaine avec date de limite
   */
  planWeekUntil(maintenance: any) {
    let nbWeek;
    const newMaintenances: any &#x3D; [];
    const time &#x3D; moment(maintenance.StartTime).format(&#x27;LT&#x27;);


    while (moment(maintenance.StartTime).isBefore(maintenance.until)) {
      nbWeek &#x3D; moment(moment(maintenance.StartTime)).week();

      maintenance.listDay.forEach(element &#x3D;&gt; {
        const date &#x3D; (moment().day(element).week(nbWeek).format(&#x27;LL&#x27;));
        maintenance.StartTime &#x3D; (moment(date + &#x27; &#x27; + time).format(&#x27;llll&#x27;));
        this.traitementPlanByDay(maintenance, newMaintenances);

      });

      maintenance.StartTime &#x3D; moment(maintenance.StartTime).add(maintenance.interval, &#x27;weeks&#x27;);

    }
    this.messageEvent.emit(newMaintenances);
    this.createForm();
  }
  //#endregion

  //#region save by Day
  /**
   *
   * @param maintenance
   * determine si la fin de la plannification
   * se fait selon une date limite ou un nombre de repetition
   * pour plannification par jour
   */
  saveDaily(maintenance) {
    if (maintenance.end &#x3D;&#x3D;&#x3D; &#x27;Until&#x27;) { this.planDayUntil(maintenance); } else { this.planDayCount(maintenance); }

  }

  // TODO Hicham Date depasse tjs de 1
  planDayUntil(maintenance) {
    const newMaintenances: any &#x3D; [];
    while (moment(maintenance.StartTime).isBefore(maintenance.until)) {
      this.traitementPlanByDay(maintenance, newMaintenances);
    }
    this.messageEvent.emit(newMaintenances);
    this.createForm();
  }

  planDayCount(maintenance) {
    const newMaintenances: any &#x3D; [];
    for (let index &#x3D; 1; index &lt;&#x3D; maintenance.count; index++) {
      this.traitementPlanByDay(maintenance, newMaintenances);
    }
    this.messageEvent.emit(newMaintenances);
    this.createForm();
  }
  //#endregion


  //#region Tools
  /**
 *
 * @param current definit le numero de la semaine
 * @param date definit le mois a traité
 * @param maintenance definit le jour de la semaine
 *
 * si current &#x3D;&#x3D; 1 premier semaine
 * permet de calculer soit premier &quot;jour (ex:lundi du mois&quot;)
 *
 * si current &#x3D;&#x3D; 2 deuxieme semaine
 * permet de calculer soit deuxieme &quot;jour (ex:lundi du mois&quot;)
 */
  traitementCurrentByMonth(current, date, maintenance) {
    if (current &#x3D;&#x3D; 1) {

      date &#x3D; moment(date, &#x27;M YYYY&#x27;).startOf(&#x27;month&#x27;).day(maintenance.day);
      maintenance.StartTime &#x3D; this.firstWeek(date);



    } else if (current &#x3D;&#x3D; 2) {
      date &#x3D; moment(date, &#x27;M YYYY&#x27;).startOf(&#x27;month&#x27;).day(maintenance.day);
      date &#x3D; this.firstWeek(date);


      // startOf(&#x27;month) return first week of month day(&#x27;maintenance.day&#x27;) var with number of day add(7,&#x27;d&#x27;) add 7 days up first day
      maintenance.StartTime &#x3D; moment(date).add(7, &#x27;d&#x27;);


    } else if (current &#x3D;&#x3D; 3) {
      date &#x3D; moment(date, &#x27;M YYYY&#x27;).startOf(&#x27;month&#x27;).day(maintenance.day);
      date &#x3D; this.firstWeek(date);
      // startOf(&#x27;month) return first week of month day(&#x27;maintenance.day&#x27;) var with number of day add(14,&#x27;d&#x27;) add 14 days up first day
      maintenance.StartTime &#x3D; moment(date).add(14, &#x27;d&#x27;);
      //TODO verifier si c&#x27;est pas 30 ou 31 modifier date

    } else {
      // endOF(&#x27;month) return last week of month day(&#x27;maintenance.day&#x27;) var with number of day
      maintenance.StartTime &#x3D; this.checkLastWeekofMonth(moment(date, &#x27;M YYYY&#x27;).endOf(&#x27;month&#x27;).day(maintenance.day));

      // maintenance.StartTime &#x3D; moment(date, &quot;M YYYY&quot;).endOf(&#x27;month&#x27;).day(maintenance.day);

    }
  }
  checkLastWeekofMonth(date) {

    if (date.format(&#x27;DD&#x27;) &lt; 10) {
      date.add(-1, &#x27;w&#x27;);
      return date;
    }
    return date;
  }
  firstWeek(date) {
    if (date.format(&#x27;DD&#x27;) &gt; 20) {
      return date.add(1, &#x27;w&#x27;);
    } else {
      return date;
    }
  }
  traitementByMonth(maintenance,newMaintenances,date,time){
    if (maintenance.choix &#x3D;&#x3D;&#x3D; &#x27;current&#x27;) {
      this.traitementCurrentByMonth(maintenance.current, date, maintenance);
      maintenance.StartTime &#x3D; (moment(maintenance.StartTime.format(&#x27;ll&#x27;) + &#x27; &#x27; + time).format(&#x27;llll&#x27;));
      this.traitementPlanByDay(maintenance, newMaintenances);

      maintenance.StartTime &#x3D; date.add(maintenance.interval, &#x27;M&#x27;);
    } else {
      maintenance.StartTime &#x3D; date.date(maintenance.dayOcc).format(&quot;llll&quot;)
      this.traitementPlanByDay(maintenance, newMaintenances)
      maintenance.StartTime &#x3D; date.add(maintenance.interval, &#x27;M&#x27;);
    }
  }
  traitementPlanByDay(maintenance, newMaintenances) {
    maintenance.StartTime &#x3D; moment(maintenance.StartTime).format(&#x27;LLLL&#x27;);
    maintenance.EndTime &#x3D; this.addTime(moment(maintenance.StartTime, &#x27;LLLL&#x27;), maintenance.duration);
   
    const dayMain: DayMain &#x3D; {
      StartTime: maintenance.StartTime,
      EndTime: maintenance.EndTime,
      Subject: maintenance.maintenance,
      idMaintenance: maintenance.idMaintnance
    };

    newMaintenances.push(dayMain);

    maintenance.StartTime &#x3D; moment(maintenance.StartTime, &#x27;LLLL&#x27;).add(maintenance.interval, &#x27;days&#x27;);

  }
  addTime(StartTime, duration) {
    // split  string nb unité (hours or minutes)
    const tab &#x3D; duration.split(&#x27; &#x27;);
    let EndTime;
    let mesureTemps &#x3D; tab[1];
    if (mesureTemps[0] &#x3D;&#x3D;&#x3D; &#x27;h&#x27; || mesureTemps[0] &#x3D;&#x3D;&#x3D; &#x27;H&#x27;) { mesureTemps &#x3D; &#x27;hours&#x27;; }
    if (mesureTemps[0] &#x3D;&#x3D;&#x3D; &#x27;m&#x27; || mesureTemps[0] &#x3D;&#x3D;&#x3D; &#x27;M&#x27;) { mesureTemps &#x3D; &#x27;m&#x27;; }

    EndTime &#x3D; moment(StartTime, &#x27;LLLL&#x27;).add(tab[0], mesureTemps);
    return moment(EndTime).format(&#x27;LLLL&#x27;);

  }
  //#endregion


  
  public onChangeDrop(): void {
    // enable or disable the dropdown button in Multiselect based on CheckBox checked state
    this.mulObj.showDropDownIcon &#x3D; this.dropdownObj.checked;
  }
  public onChangeReorder(): void {
    // enable or disable the list reorder in Multiselect based on CheckBox checked state
    this.mulObj.enableSelectionOrder &#x3D; this.reorderObj.checked;
  }
}
export interface DayMain {
  StartTime?: Date;
  EndTime?: Date;
  Subject?: string;
  idMaintenance?: any;
}
</code></pre>
    </div>
</div>






                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> result-matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'interface';
            var COMPODOC_CURRENT_PAGE_URL = 'DayMain.html';
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>
       <!-- Required to polyfill modern browsers as code is ES5 for IE... -->
       <script src="../js/libs/custom-elements-es5-adapter.js" charset="utf-8" defer></script>
       <script src="../js/menu-wc.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
